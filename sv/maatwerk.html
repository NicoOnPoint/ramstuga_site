<!doctype html>
<html lang="sv">
<head>
  <meta charset="utf-8">
  <title>Måttbeställt</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="/assets/style.css">
  <link rel="icon" href="/assets/favicon/favicon.ico">
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon/favicon-16x16.png">
  <link rel="apple-touch-icon" href="/assets/favicon/apple-touch-icon.png">

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-3PEW6XG51V"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag("js", new Date());
  var consentChoice = "unknown";
  try { consentChoice = localStorage.getItem("ramstuga_consent_v1") || "unknown"; } catch (e) {}
  var analyticsGranted = consentChoice === "accepted";
  gtag("consent", "default", {
    analytics_storage: analyticsGranted ? "granted" : "denied",
    ad_storage: "denied",
    ad_user_data: "denied",
    ad_personalization: "denied"
  });
  gtag("config", "G-3PEW6XG51V");
</script>
</head>
<body class="page-maatwerk">
<header class="site-header">
  <div class="container nav">
    <a class="brand" href="index.html">
      <img src="/assets/logo.png" alt="RAMSTUGA logo" class="site-logo">
      <span class="brand-text">RAMSTUGA</span>
    </a>
    <nav class="site-nav">
      <ul id="siteMenu">
        <li><a href="index.html">Hem</a></li>
        <li><a href="about.html">Om oss</a></li>
        <li><a href="maatwerk.html">Måttbeställt</a></li>
        <li><a href="portfolio.html">Portfolio</a></li>
        <li><a href="shop.html">Shop</a></li>
        <li><a href="retur.html">Returvillkor</a></li>
        <li class="lang-switch" aria-label="Språk">
          <a href="maatwerk.html" data-lang="sv">SV</a>
          <span>•</span>
          <a href="../en/maatwerk.html" data-lang="en">EN</a>
          <span>•</span>
          <a href="../nl/maatwerk.html" data-lang="nl">NL</a>
        </li>
          <!-- Cart icon moved outside nav for mobile -->
      </ul>
      <button class="nav-toggle" type="button" aria-label="Meny" aria-expanded="false">☰</button>
        <a href="shop.html" class="nav-cart mobile-only" aria-label="Varukorg">
          <svg width="22" height="22" viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path d="M6 6h15l-2 9H7L6 6Z" stroke="currentColor" stroke-width="1.6" stroke-linejoin="round"/>
            <path d="M6 6 5 3H2" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/>
            <circle cx="9" cy="20" r="1" fill="currentColor"/>
            <circle cx="18" cy="20" r="1" fill="currentColor"/>
          </svg>
          <span data-cart-count="true" class="cart-count">0</span>
        </a>
    </nav>
  </div>
</header>
<main>
  <section class="about-hero">
    <div class="container about-hero-inner">
      <div class="about-plaque" aria-hidden="true"></div>
      <div class="plaque-brandline">
        <img src="/assets/logo.png" alt="RAMSTUGA logo" class="plaque-logo">
        <span class="plaque-brandtext">RAMSTUGA</span>
      </div>
      <h1 class="about-title type-title" data-text="Måttbeställt"></h1>
      <p class="about-subtitle type-title-late typewriter" data-text="Beställ en ram som passar perfekt i ditt hem.">
        Beställ en ram som passar perfekt i ditt hem.
      </p>
    </div>
  </section>

  <section class="about-story">
    <div class="container" style="width:min(1100px,92vw);">
      <div class="section-title" style="margin-bottom:18px; flex-direction: column; align-items: flex-start;">
        <h2>Beställning på mått</h2>
        <div class="subtle" style="margin-top:6px;">Fyll i så mycket som möjligt så att vi kan svara snabbt.</div>
      </div>

      <div id="shopPrefillCard" class="card pad" style="max-width:980px; margin:0 auto 14px; display:none;">
        <div style="display:flex; align-items:center; gap:12px;">
          <img id="shopPrefillImg" src="" alt="" style="width:64px; height:64px; object-fit:cover; border-radius:8px; display:none;">
          <div>
            <strong>Vald i shoppen</strong>
            <div id="shopPrefillText" class="subtle"></div>
          </div>
        </div>
      </div>

      <div class="card pad" style="max-width:980px; margin:0 auto;">
        <form id="customOrderForm">
          <input type="hidden" name="shop_product_name" id="shopProductName" />
          <input type="hidden" name="shop_product_img" id="shopProductImg" />
          <input type="hidden" name="shop_product_size" id="shopProductSize" />
          <input type="hidden" name="shop_product_color" id="shopProductColor" />
          <input type="hidden" name="shop_product_orientation" id="shopProductOrientation" />
          <div class="form-grid">
            <label>
              Bredd invändigt (mm)
              <input type="number" name="width_mm" min="1" required placeholder="T.ex. 300" />
            </label>
            <label>
              Höjd invändigt (mm)
              <input type="number" name="height_mm" min="1" required placeholder="T.ex. 400" />
            </label>
          </div>

          <div class="form-grid">
            <label>
              Listtjocklek (mm)
              <select name="frame_thickness_mm" required>
                <option value="25">25 mm</option>
                <option value="35" selected>35 mm</option>
                <option value="45">45 mm</option>
                <option value="custom">Annat (skriv i önskemål)</option>
              </select>
            </label>
            <label>
              Synligt fönster för foto/konst (mm)
              <input type="text" name="window_mm" placeholder="T.ex. 280x380 (valfritt)" />
            </label>
          </div>

          <div class="form-grid">
            <label>
              Träslag
              <select name="wood_type" required>
                <option value="atervunnet" selected>Återvunnet trä (rustikt)</option>
                <option value="furu">Furu</option>
                <option value="ek">Ek</option>
                <option value="bjork">Björk</option>
                <option value="annat">Annat (skriv i önskemål)</option>
              </select>
            </label>
            <label>
              Ytbehandling / färg
              <select name="finish" required>
                <option value="natur" selected>Natur / matt olja</option>
                <option value="ljus">Ljus (whitewash / ljus olja)</option>
                <option value="mork">Mörk (valnötslook)</option>
                <option value="gra">Grå väderbiten</option>
                <option value="farg">Färg (skriv i önskemål)</option>
              </select>
            </label>
          </div>

          <div class="form-grid">
            <label>
              Orientering
              <select name="orientation" required>
                <option value="staende">Stående</option>
                <option value="liggande">Liggande</option>
                <option value="kvadrat">Kvadrat</option>
              </select>
            </label>
            <label>
              Glas / plexi
              <select name="front" required>
                <option value="ingen" selected>Ingen (öppen ram)</option>
                <option value="glas">Glas</option>
                <option value="plexi">Plexiglas</option>
              </select>
            </label>
          </div>

          <div class="form-grid">
            <label>
              Upphängning
              <select name="hanging" required>
                <option value="standard" selected>Standard (beslag/krok)</option>
                <option value="tagg">Tagghängare</option>
                <option value="trad">Tråd</option>
                <option value="annat">Annat (skriv i önskemål)</option>
              </select>
            </label>
            <label>
              Bakstycke
              <select name="back_panel" id="backPanelSelect" required>
                <option value="Kartong" selected>Kartong</option>
                <option value="Plywood 3 mm">Plywood 3 mm</option>
                <option value="annat">Annat (ange själv)</option>
              </select>
            </label>
          </div>

          <label id="backPanelCustomWrap" style="display:none;">
            Bakstycke (ange själv)
            <input type="text" name="back_panel_custom" id="backPanelCustomInput" placeholder="T.ex. MDF 2,5 mm" />
          </label>

          <div class="form-grid">
            <label>
              Antal
              <input type="number" name="qty" min="1" value="1" required />
            </label>
          </div>

          <label>
            Specifika önskemål (färgkod, referenslänk, hörnfinish, etc.)
            <textarea name="notes" placeholder="Berätta vad du har i åtanke..."></textarea>
          </label>

          <div class="section-title" style="margin-top:16px;">
            <h2>Kontakt</h2>
            <div class="subtle">För offert och uppföljning</div>
          </div>

          <div class="form-grid">
            <label>
              Namn
              <input type="text" name="customer_name" required placeholder="Ditt namn" />
            </label>
            <label>
              E-post
              <input type="email" name="customer_email" required placeholder="namn@mail.se" />
            </label>
          </div>

          <label>
            Telefon (valfritt)
            <input type="tel" name="customer_phone" placeholder="+46 / +31 / ..." />
          </label>

          <div class="form-actions">
            <button class="btn primary" type="submit">Skicka förfrågan</button>
          </div>

          <p class="fineprint">
            * Måttbeställt hanteras oftast som offert. Vi kontaktar dig med pris och leveranstid.
          </p>
          <div class="contact-buttons">
            <a class="btn" href="tel:+46707106182">Ring</a>
            <a class="btn" href="sms:+46707106182?body=Hej%2C%20jag%20vill%20ha%20mer%20information%20om%20ramar">SMS</a>
            <a class="btn" href="https://wa.me/46707106182?text=Hej%2C%20jag%20vill%20ha%20mer%20information" target="_blank" rel="noopener">WhatsApp</a>
          </div>
        </form>
      </div>
    </div>
  </section>
</main>
<footer class="site-footer">
  <div class="container footer-inner">
    <div class="footer-plaque" role="contentinfo" aria-label="Kontaktuppgifter">
      <div class="plaque-content">
        <p class="plaque-brand"></p>
        <p class="plaque-line"><strong>E-post:</strong> <a href="mailto:info@ramstuga.se">info@ramstuga.se</a></p>
        <p class="plaque-line"><strong>Namn:</strong> Nico &amp; Barbara</p>
        <p class="plaque-line subtle">Handgjort för ditt hem</p>
      </div>
    </div>
    <p class="footer-credit">© Webdesign by <a href="https://www.nico-on-point-webdesign.com" target="_blank" rel="noopener">www.nico-on-point-webdesign.com</a></p>
    <div class="contact-buttons">
      <a class="btn" href="tel:+46707106182">Ring</a>
      <a class="btn" href="sms:+46707106182?body=Hej%2C%20jag%20vill%20ha%20mer%20information%20om%20ramar">SMS</a>
      <a class="btn" href="https://wa.me/46707106182?text=Hej%2C%20jag%20vill%20ha%20mer%20information" target="_blank" rel="noopener">WhatsApp</a>
    </div>
    <p class="footer-copy">© <span id="year"></span> RAMSTUGA</p>
  </div>
</footer>
<script src="/assets/script.js?v=20260221b" defer></script>
<script>
  function formToObject(form) {
    const data = new FormData(form);
    const obj = {};
    for (const [k, v] of data.entries()) obj[k] = String(v).trim();
    return obj;
  }

  function buildSummary(o) {
    const backPanel = o.back_panel === "annat" ? (o.back_panel_custom || "Annat (inte angivet)") : (o.back_panel || "-");
    const shopSelection = o.shop_product_name ? [
      "",
      "Vald i shoppen:",
      `Produkt: ${o.shop_product_name}`,
      o.shop_product_size ? `Önskad storlek: ${o.shop_product_size}` : null,
      o.shop_product_color ? `Önskad färg: ${o.shop_product_color}` : null,
      o.shop_product_orientation ? `Önskad orientering: ${o.shop_product_orientation}` : null,
      o.shop_product_img ? `Bild: ${o.shop_product_img}` : null
    ].filter(Boolean) : [];
    return [
      "Måttbeställd ram",
      "",
      `Mått: ${o.width_mm} x ${o.height_mm} mm`,
      `Listtjocklek: ${o.frame_thickness_mm} mm`,
      o.window_mm ? `Fönster: ${o.window_mm}` : null,
      `Träslag: ${o.wood_type}`,
      `Ytbehandling: ${o.finish}`,
      `Orientering: ${o.orientation}`,
      `Glas/Plexi: ${o.front}`,
      `Upphängning: ${o.hanging}`,
      `Bakstycke: ${backPanel}`,
      `Antal: ${o.qty}`,
      ...shopSelection,
      "",
      `Önskemål: ${o.notes || "-"}`,
      "",
      `Kontakt: ${o.customer_name} (${o.customer_email}${o.customer_phone ? ", " + o.customer_phone : ""})`
    ].filter(Boolean).join("\n");
  }

  function initShopPrefill() {
    const url = new URL(window.location.href);
    const data = {
      name: String(url.searchParams.get("from_shop_name") || "").trim(),
      img: String(url.searchParams.get("from_shop_img") || "").trim(),
      size: String(url.searchParams.get("from_shop_size") || "").trim(),
      color: String(url.searchParams.get("from_shop_color") || "").trim(),
      orientation: String(url.searchParams.get("from_shop_orientation") || "").trim(),
      notes: String(url.searchParams.get("from_shop_notes") || "").trim()
    };

    const nameInput = document.getElementById("shopProductName");
    const imgInput = document.getElementById("shopProductImg");
    const sizeInput = document.getElementById("shopProductSize");
    const colorInput = document.getElementById("shopProductColor");
    const orientationInput = document.getElementById("shopProductOrientation");

    if (nameInput) nameInput.value = data.name;
    if (imgInput) imgInput.value = data.img;
    if (sizeInput) sizeInput.value = data.size;
    if (colorInput) colorInput.value = data.color;
    if (orientationInput) orientationInput.value = data.orientation;
    const notesInput = document.querySelector('textarea[name="notes"]');
    if (notesInput && data.notes && !notesInput.value.trim()) notesInput.value = data.notes;

    if (!data.name) return;

    const card = document.getElementById("shopPrefillCard");
    const text = document.getElementById("shopPrefillText");
    const img = document.getElementById("shopPrefillImg");
    const details = [
      data.name,
      data.size ? `Storlek: ${data.size}` : null,
      data.color ? `Färg: ${data.color}` : null,
      data.orientation ? `Orientering: ${data.orientation}` : null
    ].filter(Boolean).join(" • ");

    if (text) text.textContent = details;
    if (img && data.img) {
      img.src = data.img;
      img.alt = data.name || "Vald ram";
      img.style.display = "block";
    }
    if (card) card.style.display = "block";
  }

  const yearEl = document.getElementById("year");
  if (yearEl) yearEl.textContent = new Date().getFullYear();
  initShopPrefill();

  const form = document.getElementById("customOrderForm");
  const backPanelSelect = document.getElementById("backPanelSelect");
  const backPanelCustomWrap = document.getElementById("backPanelCustomWrap");
  const backPanelCustomInput = document.getElementById("backPanelCustomInput");

  function updateBackPanelCustomVisibility() {
    const isCustom = backPanelSelect && backPanelSelect.value === "annat";
    if (backPanelCustomWrap) backPanelCustomWrap.style.display = isCustom ? "block" : "none";
    if (backPanelCustomInput) backPanelCustomInput.required = !!isCustom;
    if (!isCustom && backPanelCustomInput) backPanelCustomInput.value = "";
  }

  if (backPanelSelect) {
    backPanelSelect.addEventListener("change", updateBackPanelCustomVisibility);
    updateBackPanelCustomVisibility();
  }

  form.addEventListener("submit", (e) => {
    e.preventDefault();
    const o = formToObject(form);
    const subject = encodeURIComponent("Offertförfrågan - RAMSTUGA");
    const body = encodeURIComponent(buildSummary(o));
    const mailtoUrl = `mailto:info@ramstuga.se?subject=${subject}&body=${body}`;
    const mailWindow = window.open(mailtoUrl, "_blank");
    if (!mailWindow) window.location.href = mailtoUrl;
    setTimeout(() => {
      window.location.href = "tack.html";
    }, 250);
  });
</script>
</body>
</html>
